import{c as g,u as k,r as l,j as e,L as I,a as m}from"./index-D1PmyStg.js";import{b as O,u as D}from"./orders-lTb7AU2X.js";const A=()=>{const{id:x}=g(),{currentUser:S,isTailor:n}=k(),[s,j]=l.useState(null),[d,v]=l.useState(null),[N,p]=l.useState(!0),[r,u]=l.useState(!1),[o,h]=l.useState(null);l.useEffect(()=>{(async()=>{try{p(!0),h(null);const a=await O(x);j(a),v(a.tailorId)}catch(a){h(a.message||"Failed to load order details")}finally{p(!1)}})()},[x,n]);const c=async i=>{try{u(!0),h(null);const a=await D(x,i);j(a)}catch{h("Failed to update order status")}finally{u(!1)}},b=()=>{if(!n)return null;switch(s.status){case"placed":return e.jsxs("div",{className:"status-actions",children:[e.jsx("button",{className:"btn btn-success",onClick:()=>c("accepted"),disabled:r,children:r?"Accepting...":"Accept Order"}),e.jsx("button",{className:"btn btn-error",onClick:()=>c("rejected"),disabled:r,children:r?"Rejecting...":"Reject Order"})]});case"accepted":return e.jsx("div",{className:"status-actions",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>c("in-progress"),disabled:r,children:r?"Updating...":"Mark as In Progress"})});case"in-progress":return e.jsx("div",{className:"status-actions",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>c("ready"),disabled:r,children:r?"Updating...":"Mark as Ready for Delivery/Pickup"})});case"ready":return e.jsx("div",{className:"status-actions",children:e.jsx("button",{className:"btn btn-success",onClick:()=>c("delivered"),disabled:r,children:r?"Updating...":"Mark as Delivered/Picked Up"})});default:return null}},t=i=>{const a=["placed","accepted","in-progress","ready","delivered"],f=a.indexOf(s.status),y=a.indexOf(i);return s.status==="rejected"?i==="placed"?"completed":"":y<=f?"completed":""};return N?e.jsx(I,{}):o?e.jsxs("div",{className:"error-container\\",role:"alert",children:[e.jsx("h2",{children:"Error"}),e.jsx("p",{children:o}),e.jsx(m,{to:n?"/tailor-dashboard":"/dashboard",className:"btn btn-primary",children:"Back to Dashboard"})]}):s?e.jsxs("div",{className:"order-details-page",children:[e.jsx("div",{className:"back-link",children:e.jsx(m,{to:n?"/tailor-dashboard":"/dashboard",children:"← Back to Dashboard"})}),e.jsxs("div",{className:"order-details-container",children:[e.jsxs("div",{className:"order-details-header",children:[e.jsxs("div",{children:[e.jsxs("h1",{children:["Order #",s._id.slice(-8)]}),e.jsxs("p",{className:"order-date",children:["Placed on ",new Date(s.createdAt).toLocaleDateString()," at"," ",new Date(s.createdAt).toLocaleTimeString()]})]}),e.jsx("div",{className:"order-status-container",children:e.jsx("span",{className:`status-pill status-${s.status}`,children:s.status.replace("-"," ")})})]}),o&&e.jsx("div",{className:"alert alert-error",role:"alert",children:o}),e.jsxs("div",{className:"order-sections",children:[e.jsxs("div",{className:"order-main-section",children:[e.jsxs("div",{className:"order-card",children:[e.jsx("h2",{children:"Items"}),e.jsx("div",{className:"order-items",children:s.items.map((i,a)=>e.jsxs("div",{className:"order-item-row",children:[e.jsxs("div",{className:"item-info",children:[e.jsx("h3",{children:i.description}),e.jsxs("p",{className:"fabric",children:["Fabric: ",i.fabric]}),e.jsxs("div",{className:"measurement-details",children:[e.jsx("h4",{children:"Measurements:"}),e.jsx("p",{children:i.measurements})]})]}),e.jsxs("div",{className:"item-price",children:["₹",i.price]})]},a))}),e.jsxs("div",{className:"order-total",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["₹",s.price]})]})]}),e.jsxs("div",{className:"order-card",children:[e.jsx("h2",{children:"Delivery Information"}),e.jsxs("div",{className:"delivery-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Delivery Option:"}),e.jsx("span",{className:"info-value",children:s.deliveryOption==="home_delivery"?"Home Delivery":"Pickup from Shop"})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Payment Method:"}),e.jsx("span",{className:"info-value",children:s.paymentMethod==="cash"?"Cash":"UPI"})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Customer Address:"}),e.jsx("span",{className:"info-value",children:s.userId.address})]})]})]}),(d||s.tailorId)&&e.jsxs("div",{className:"order-card",children:[e.jsx("h2",{children:"Tailor Information"}),e.jsx("div",{className:"tailor-info",children:d?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:d.avatar||"https://images.pexels.com/photos/1043471/pexels-photo-1043471.jpeg?auto=compress&cs=tinysrgb&w=150",alt:d.userId.name,className:"tailor-avatar"}),e.jsxs("div",{children:[e.jsx("h3",{children:d.userId.name}),e.jsx("p",{children:d.shopAddress}),e.jsxs("p",{className:"tailor-contact",children:["Phone: ",d.userId.phone]}),e.jsx(m,{to:`/tailor/${d._id}`,className:"btn btn-outline btn-sm",children:"View Shop"})]})]}):e.jsxs("div",{children:[e.jsx("h3",{children:s.tailorId.name||"Tailor"}),e.jsx("p",{children:s.tailorId.shopAddress||"Shop address not available"}),e.jsxs("p",{className:"tailor-contact",children:["Phone: ",s.tailorId.phone||"Not available"]})]})})]})]}),e.jsxs("div",{className:"order-side-section",children:[e.jsxs("div",{className:"order-card",children:[e.jsx("h2",{children:"Order Timeline"}),e.jsxs("div",{className:"order-timeline",children:[e.jsxs("div",{className:`timeline-item ${t("placed")}`,children:[e.jsx("div",{className:"timeline-point"}),e.jsxs("div",{className:"timeline-content",children:[e.jsx("h4",{children:"Order Placed"}),e.jsx("p",{children:new Date(s.createdAt).toLocaleDateString()})]})]}),s.status!=="rejected"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`timeline-item ${t("accepted")}`,children:[e.jsx("div",{className:"timeline-point"}),e.jsxs("div",{className:"timeline-content",children:[e.jsx("h4",{children:"Order Accepted"}),e.jsx("p",{children:t("accepted")==="completed"?"Tailor has accepted your order":"Waiting for tailor to accept"})]})]}),e.jsxs("div",{className:`timeline-item ${t("in-progress")}`,children:[e.jsx("div",{className:"timeline-point"}),e.jsxs("div",{className:"timeline-content",children:[e.jsx("h4",{children:"In Progress"}),e.jsx("p",{children:t("in-progress")==="completed"?"Stitching in progress":"Not started yet"})]})]}),e.jsxs("div",{className:`timeline-item ${t("ready")}`,children:[e.jsx("div",{className:"timeline-point"}),e.jsxs("div",{className:"timeline-content",children:[e.jsx("h4",{children:"Ready"}),e.jsx("p",{children:t("ready")==="completed"?"Ready for delivery/pickup":"Waiting for completion"})]})]}),e.jsxs("div",{className:`timeline-item ${t("delivered")}`,children:[e.jsx("div",{className:"timeline-point"}),e.jsxs("div",{className:"timeline-content",children:[e.jsx("h4",{children:"Delivered"}),e.jsx("p",{children:t("delivered")==="completed"?"Order completed successfully":"Waiting for delivery/pickup"})]})]})]}),s.status==="rejected"&&e.jsxs("div",{className:"timeline-item completed",children:[e.jsx("div",{className:"timeline-point"}),e.jsxs("div",{className:"timeline-content",children:[e.jsx("h4",{children:"Order Rejected"}),e.jsx("p",{children:"Tailor was unable to accept this order"})]})]})]})]}),b()]})]})]})]}):e.jsxs("div",{className:"error-container",children:[e.jsx("h2",{children:"Order not found"}),e.jsx("p",{children:"The order you're looking for doesn't exist or you don't have permission to view it."}),e.jsx(m,{to:n?"/tailor-dashboard":"/dashboard",className:"btn btn-primary",children:"Back to Dashboard"})]})};export{A as default};
